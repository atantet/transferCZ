GSL_DIR := ../../../gslsp/src/
INCDIR=-I$(GSL_DIR)
LIBDIR=
LIBS=-lgsl -lconfig++

CC=g++
WARN=-Wall -Wformat=0
CFLAGS=$(WARN) -pedantic-errors -O3
LDFLAGSSTD=-undefined dynamic_lookup
LDFLAGSGDB=$(LDFLAGSSTD) -gdb
GSL_SRC := $(shell find $(GSL_DIR) -name "*.c")
GSL_SRC := $(filter-out $(GSL_DIR)/test.c, $(GSL_SRC))
GSL_OBJ := $(patsubst %.c, %.o, $(GSL_SRC))

# Use OpenMP?
ifeq ($(WITH_OMP),1)
  LIBS +=-lgomp
  CFLAGS += -fopenmp -DWITH_OMP=$(WITH_OMP)
endif

LDFLAGS=$(LDFLAGSSTD)
#LDFLAGS=$(LDFLAGSGDB)

EXE=transferCZ

all:$(EXE).out

$(EXE).o:$(EXE).cpp $(GSL_SRC)
	$(CC) -c $(CFLAGS) $(INCDIR) $(EXE).cpp $(GSL_SRC)

$(EXE).out:$(EXE).o $(GSL_OBJ)
	$(CC) $(LDFLAGS) -o $(EXE).out $(LIBDIR) $(EXE).o $(GSL_OBJ) $(LIBS)

clean:
	rm -f $(EXE).o $(EXE).out

cleanall:
	rm -f $(GSL_DIR)/*.o $(EXE).o $(EXE).out
